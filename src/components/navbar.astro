---
import ThemeToggle from './theme-toggle.astro';
import Logo from './logo.astro';
---

<nav aria-label="Main navigation">
	<div class="nav-wrapper readable-width flex items-center justify-between w-full h-full">
		<div class="nav-logo-header">
			<a href="/" aria-label="TidyTrek home">
				<Logo />
			</a>
		</div>
		<div class="auth-button-container flex items-center gap-8" role="group" aria-label="Authentication actions">
			<ThemeToggle />
			<a href="https://tidytrek.co/login" rel="noopener noreferrer" class="btn-primary" role="button">Login</a>
			<a href="https://tidytrek.co/register" rel="noopener noreferrer" class="btn-primary desktop-only" role="button"
				>Sign Up</a
			>
		</div>
	</div>
</nav>

<style>
	nav {
		background-color: transparent;
		height: var(--navbar-height);
		position: fixed;
		z-index: 100;
		width: 100%;
		top: 0;
		transition:
			background-color var(--transition),
			backdrop-filter var(--transition);
	}

	nav.scrolled {
		background-color: var(--color-bg-secondary);
		backdrop-filter: blur(15px) saturate(150%);
		border-bottom: var(--border-primary);
	}

	.nav-logo-header {
		display: flex;
		align-items: center;
	}

	/* When navbar is NOT scrolled (transparent), use theme text color */
	nav:not(.scrolled) .logo-svg {
		color: var(--color-text-primary);
	}

	/* Dark mode - use white logo when not scrolled */
	:global([data-theme='dark']) nav:not(.scrolled) .logo-svg {
		color: white;
	}

	@media (max-width: 768px) {
		.desktop-only {
			display: none;
		}
	}
</style>

<script>
	const handleNavbarScroll = () => {
		const navbar = document.querySelector('nav');
		const scrollBoundary = 50;

		const updateNavbar = () => {
			if (window.scrollY > scrollBoundary) {
				navbar?.classList.add('scrolled');
			} else {
				navbar?.classList.remove('scrolled');
			}
		};

		window.addEventListener('scroll', updateNavbar);
		updateNavbar();
	};

	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', handleNavbarScroll);
	} else {
		handleNavbarScroll();
	}
</script>
